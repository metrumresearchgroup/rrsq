```{r}
Sys.setenv(
  RSQ_API_ROOT="",
  RSQ_API_HOST="",
  RSQ_API_PORT=""
)

# Should work (but be invalid)
ac <- create_api_config(test_ping=F)

# Should fail
ac <- create_api_config(test_ping=T)

## Make sure to reset
```

```{r}
## Run before running tests below
set_default_env_vars()
ac <- create_api_config()
set_api_config(api_config = ac)
```
```{r}
# Test ping
ping()
```


```{r}
# test get_jobs
a <- get_jobs()
b <- get_jobs(users = "Dreznel")
c <- get_jobs(users = c("Dreznel", "John Carlo"))
d <- get_jobs(statuses = "ERROR")
e <- get_jobs(statuses = c("COMPLETED","ERROR"))
f <- get_jobs(statuses = c("COMPLETED"))

a
b
c
d
e
f
```

```{r}
# Make sure get_jobs fails when invalid status given
will_fail <- get_jobs(statuses = "INVALID_STATUS")
```

```{r}
# Get job

j1 <- get_job(1)
j1

j1again <- get_job(j1, return_df = TRUE)
j1again
```

```{r}
# SubmitJob2
submitted_job <- submit_job2(
  user = "johncarlos",
  context = "test job",
  rscript_path = "/Users/johncarlos/openspace/rrsq/hello.R",
  work_dir = "/Users/johncarlos/openspace/rrsq"
)
get_job(submitted_job, return_df = T)
Sys.sleep(3)
get_job(submitted_job, return_df = T)
```

```{r}
# Get Version
# trace(what = get_version, tracer = browser)
# untrace(get_version)
get_version()
```

```{r}
# Cancel job

# I think the request works, but RSQ doesn't actually cancel the job.
submitted_job <- submit_job2(
  user = "johncarlos",
  context = "long job",
  rscript_path = "/Users/johncarlos/openspace/rrsq/long_job.R",
  work_dir = "/Users/johncarlos/openspace/rrsq"
)
result <- cancel_job(
  submitted_job
)

result

result2 <- get_job(submitted_job, return_df = T)
result2
```

